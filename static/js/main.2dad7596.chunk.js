(this["webpackJsonpveezoo-assignment-2020"]=this["webpackJsonpveezoo-assignment-2020"]||[]).push([[0],{10:function(e,t,n){e.exports=n(16)},15:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var a=n(2),i=n(3),r=n(6),l=n(5),s=n(4),o=n(0),c=n.n(o),u=n(9),d=n.n(u);n(15);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function f(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var m=c.a.createElement("path",{d:"M244 128C244 192.065 192.065 244 128 244C63.935 244 12 192.065 12 128C12 63.935 63.935 12 128 12C192.065 12 244 63.935 244 128Z",stroke:"black",strokeWidth:24}),p=function(e){var t=e.svgRef,n=e.title,a=f(e,["svgRef","title"]);return c.a.createElement("svg",h({width:256,height:256,viewBox:"0 0 256 256",fill:"none",ref:t},a),n?c.a.createElement("title",null,n):null,m)},v=c.a.forwardRef((function(e,t){return c.a.createElement(p,h({svgRef:t},e))})),E=(n.p,"https://my-json-server.typicode.com/open-veezoo/editor");var y=n(1),g=null,b=function(e){Object(l.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this)).state={open:!1,loading:!1},e}return Object(i.a)(n,[{key:"onItemPressed",value:function(){var e,t=this;if(this.props.file.isDirectory)this.setState((function(e){return{open:!e.open}}));else{var n,a,i;if((null===(n=window.mainApp)||void 0===n||null===(a=n.editor)||void 0===a||null===(i=a.state.currentFile)||void 0===i?void 0:i.id)===this.props.file.id)return;this.setState({loading:!0}),window.mainApp.forceUpdate(),g=this,(e=this.props.file.id,new Promise((function(t,n){fetch(E+"/files/"+e).then((function(e){return e.json()})).then((function(e){return t(e)})).catch((function(e){return n(e)}))}))).then((function(e){t.setState({loading:!1}),g===t&&(t.props.onFileLoaded(e),g=null,t.forceUpdate())}))}}},{key:"forceUpdate",value:function(){this.setState(this.state)}},{key:"render",value:function(){var e=this;if(this.props.file.isDirectory){var t,a=[];return this.state.open&&(a=this.props.file.children.map((function(t,a){return c.a.createElement(n,{key:a,file:t,onFileLoaded:function(t){return e.props.onFileLoaded(t)},indentation:e.props.indentation+8})}))),t=this.state.open?[c.a.createElement(y.a,{key:0}),c.a.createElement(y.e,{key:1})]:[c.a.createElement(y.b,{key:0}),c.a.createElement(y.d,{key:1})],c.a.createElement("div",{className:"filetree-filelist"},c.a.createElement("button",{onClick:function(){return e.onItemPressed()},className:"filetree-item",style:{paddingLeft:this.props.indentation+"px"}},c.a.createElement("span",{className:"filetree-item-icons folder"},t),c.a.createElement("span",{className:"filetree-item-filename"},this.props.file.name)),a)}var i,r,l,s,o="filetree-item";return g===this&&(s=c.a.createElement("span",{className:"filetree-item-loading"},c.a.createElement("span",null),c.a.createElement("span",null),c.a.createElement("span",null))),(null===(i=window.mainApp)||void 0===i||null===(r=i.editor)||void 0===r||null===(l=r.state.currentFile)||void 0===l?void 0:l.id)===this.props.file.id&&(o+=" currentfile"),c.a.createElement("button",{onClick:function(){return e.onItemPressed()},className:o,style:{paddingLeft:this.props.indentation+"px"}},c.a.createElement("span",{className:"filetree-item-icons file"},c.a.createElement(y.c,null)),c.a.createElement("span",{className:"filetree-item-filename"},this.props.file.name),s)}}]),n}(c.a.Component);b.defaultProps={indentation:8};var k=n(7),S=function(e){Object(l.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this)).state={currentFile:null,fileEdited:!1},e.textarea=null,e}return Object(i.a)(n,[{key:"loadFile",value:function(e){this.setState({currentFile:e,fileEdited:!1}),this.textarea.value=e.content,this.textarea.style.height="auto",this.textarea.style.height=this.textarea.scrollHeight+"px"}},{key:"onFileSaved",value:function(){this.setState({fileEdited:!1})}},{key:"editorInputHandle",value:function(e){if("Tab"===e.key&&!e.shiftKey){var t=this.textarea.selectionStart,n=this.textarea.selectionEnd,a=this.textarea.value;this.textarea.value=a.substring(0,t)+"\t"+a.substring(n),this.textarea.selectionStart=this.textarea.selectionEnd=t+1,e.preventDefault()}"s"===e.key&&e.ctrlKey&&this.state.fileEdited&&(this.props.onSave(this.state.currentFile),e.preventDefault())}},{key:"editorEditHandle",value:function(e){var t=this;this.textarea.value!==this.state.currentFile.content&&this.setState((function(e){return{currentFile:Object(k.a)(Object(k.a)({},e.currentFile),{},{content:t.textarea.value}),fileEdited:!0}})),this.textarea.style.height="auto",this.textarea.style.height=this.textarea.scrollHeight+"px"}},{key:"onFileClose",value:function(){this.setState({currentFile:null,fileEdited:!1},(function(){return window.mainApp.forceUpdate()}))}},{key:"render",value:function(){var e=this;if(this.state.currentFile){for(var t=this.state.currentFile.content.split("\n").length,n=[],a=0;a<t;a++)n.push(c.a.createElement("span",{key:a},a+1));return c.a.createElement("div",{className:"editor opened"},c.a.createElement("span",{className:"editor-filename"},this.state.fileEdited?this.state.currentFile.name+"*":this.state.currentFile.name,c.a.createElement("button",{onClick:function(){return e.onFileClose()},className:"file-close"})),c.a.createElement("span",{className:"editor-contents"},c.a.createElement("span",{className:"editor-lines"},n),c.a.createElement("textarea",{ref:function(t){e.textarea=t},onInput:function(t){return e.editorEditHandle()},onKeyDown:function(t){return e.editorInputHandle(t)},spellCheck:!1,defaultValue:this.state.currentFile.content})))}return c.a.createElement("div",{className:"editor"},c.a.createElement("span",{className:"empty-editor"},"Open a file from the left menu to edit"))}}]),n}(c.a.Component),F=function(e){Object(l.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this)).state={treeLoaded:!1,tree:[],saving:!1,deleting:!1,currentTheme:"dark"},e.editor=null,window.mainApp=Object(r.a)(e),e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;new Promise((function(e,t){fetch(E+"/filetree").then((function(e){return e.json()})).then((function(t){return e(t)})).catch((function(e){return t(e)}))})).then((function(t){e.setState({treeLoaded:!0,tree:t})}))}},{key:"onFileLoaded",value:function(e){this.editor.loadFile(e),this.forceUpdate()}},{key:"onFileQuerySave",value:function(e){var t,n,a,i=this;this.state.deleting||(e=null!==(t=e)&&void 0!==t?t:this.editor.state.currentFile,this.setState({saving:!0}),(n=e.id,a=e,"object"==typeof a&&(a=JSON.stringify(a)),new Promise((function(e,t){fetch(E+"/files/"+n,{method:"PUT",body:a}).then((function(t){return e(t)})).catch((function(e){return t(e)}))}))).then((function(e){i.editor.onFileSaved(),i.setState({saving:!1})})))}},{key:"onFileQueryDelete",value:function(){var e,t=this;this.state.saving||(this.setState({deleting:!0}),(e=this.editor.state.currentFile.id,new Promise((function(t,n){fetch(E+"/files/"+e,{method:"DELETE"}).then((function(e){return t(e)})).catch((function(e){return n(e)}))}))).then((function(e){t.editor.onFileClose(),t.setState({deleting:!1})})))}},{key:"forceUpdate",value:function(){this.setState(this.state)}},{key:"onThemeSwitch",value:function(){"dark"===this.state.currentTheme?this.setState({currentTheme:"light"}):this.setState({currentTheme:"dark"})}},{key:"render",value:function(){var e=this;if(document.body.className=this.state.currentTheme,this.state.treeLoaded){var t,n,a,i=c.a.createElement("button",{className:"save",title:"Save the current file (CTRL+S)",disabled:!0},c.a.createElement(y.g,null)),r=c.a.createElement("button",{className:"delete",title:"Delete the current open file",disabled:!0},c.a.createElement(y.i,null));return this.editor&&null!==this.editor.state.currentFile&&(this.state.deleting||this.state.saving||(i=c.a.createElement("button",{className:"save",title:"Save the current file (CTRL+S)",onClick:function(){return e.onFileQuerySave()}},c.a.createElement(y.g,null))),this.state.saving||this.state.deleting||(r=c.a.createElement("button",{className:"delete",title:"Delete the current open file",onClick:function(){return e.onFileQueryDelete()}},c.a.createElement(y.i,null)))),this.state.deleting?n=c.a.createElement("span",{className:"deleting-icon"}):this.state.saving&&(t=c.a.createElement("span",{className:"saving-icon"})),a="dark"===this.state.currentTheme?c.a.createElement("button",{onClick:function(){return e.onThemeSwitch()},className:"theme-switch"},c.a.createElement(y.h,null)):c.a.createElement("button",{onClick:function(){return e.onThemeSwitch()},className:"theme-switch"},c.a.createElement(y.f,null)),c.a.createElement("div",{className:"app"},c.a.createElement("div",{className:"top"},r,i,t,n),c.a.createElement("div",{className:"center"},c.a.createElement("div",{className:"sidebar"},c.a.createElement("div",{className:"filetree-filelist"},this.state.tree.map((function(t,n){return c.a.createElement(b,{key:n,file:t,onFileLoaded:function(t){return e.onFileLoaded(t)}})})))),c.a.createElement(S,{onSave:function(t){e.onFileQuerySave(t)},ref:function(t){return e.editor=t}})),c.a.createElement("div",{className:"bottom"},c.a.createElement("span",{className:"copyright"},"Copyright @ 2020, Gabriel H. P. Soares"),a))}return c.a.createElement("div",{className:"app-loading"},c.a.createElement(v,{className:"loading-circle"}),c.a.createElement("h1",null,"Booting up the awesome editor"))}}]),n}(c.a.Component);d.a.render(c.a.createElement(F,null),document.getElementById("root"))}},[[10,1,2]]]);
//# sourceMappingURL=main.2dad7596.chunk.js.map